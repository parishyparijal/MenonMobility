# ===========================================================
# Node 20 Alpine â€“ Nuxt 3 SSR dev server
# ===========================================================
FROM node:20-alpine

# -----------------------------------------------------------
# Install system dependencies
# -----------------------------------------------------------
RUN apk add --no-cache bash git

# -----------------------------------------------------------
# Set working directory
# -----------------------------------------------------------
WORKDIR /var/www/frontend

# -----------------------------------------------------------
# Copy package files and install dependencies (layer caching)
# -----------------------------------------------------------
COPY frontend/package.json frontend/package-lock.json* frontend/yarn.lock* frontend/pnpm-lock.yaml* ./
RUN npm install || true

# -----------------------------------------------------------
# Copy application files
# -----------------------------------------------------------
COPY frontend/ .

# -----------------------------------------------------------
# Expose Nuxt dev server port
# -----------------------------------------------------------
EXPOSE 3000

# -----------------------------------------------------------
# Start Nuxt dev server
# -----------------------------------------------------------
CMD ["npm", "run", "dev"]
